@page
@model PostModel
@{
    ViewData["Title"] = "Publicar Inmueble";
}

<link rel="stylesheet" href="~/css/stylePost.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

<div class="container-fluid px-4 py-5">
    <!-- Barra de progreso  -->
    <div class="progress-container mb-5">
        <div class="progress-steps-wrapper">
            <div class="progress-steps step-1">
                <div class="step active">
                    <div class="step-circle bg-primary text-white">1</div>
                    <div class="step-label fw-bold">Principales</div>
                </div>
                <div class="step-connector active"></div>
                <div class="step">
                    <div class="step-circle">2</div>
                    <div class="step-label">Multimedia</div>
                </div>
                <div class="step-connector"></div>
                <div class="step">
                    <div class="step-circle">3</div>
                    <div class="step-label">Extras</div>
                </div>
                <div class="step-connector"></div>
                <div class="step">
                    <div class="step-circle">4</div>
                    <div class="step-label">Publicar</div>
                </div>
            </div>
        </div>
    </div>
   

    <div class="row justify-content-center" style="padding-top:35px">
        <div class="col-lg-10">
            <!-- Encabezado -->
            <div class="d-flex align-items-center mb-5 p-4 bg-white rounded-3 shadow-sm border-start border-4 border-primary">
                <div class="flex-shrink-0 me-4">
                    <i class="bi bi-house-add fs-1 text-primary"></i>
                </div>
                <div>
                    <h1 class="fw-bold mb-2 text-primary">¡Hola Martin, empecemos a crear tu aviso!</h1>
                    <p class="lead text-muted mb-0">Completá los datos principales de tu propiedad</p>
                </div>
            </div>

            <form method="post" class="needs-validation" novalidate>
                <!-- Sección de tipo de operación mejorada -->
                <div class="card mb-4 border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom-0 py-3">
                        <h5 class="mb-0 fw-bold text-primary">
                            <i class="bi bi-tags me-2"></i>Tipo de operación
                        </h5>
                    </div>
                    <div class="card-body pt-0">
                        <div class="row g-2">
                            <div class="col-md-6">
                                <input type="radio" class="btn-check" name="Operacion" id="alquiler" value="Alquiler" required>
                                <label class="btn btn-outline-primary w-100 py-3" for="alquiler">
                                    <i class="bi bi-house-door fs-4 d-block mb-2"></i>
                                    <span class="fw-bold">Alquiler</span>
                                    <small class="d-block text-muted">Contrato a largo plazo</small>
                                </label>
                            </div>
                            <div class="col-md-6">
                                <input type="radio" class="btn-check" name="Operacion" id="temporal" value="Temporal">
                                <label class="btn btn-outline-primary w-100 py-3" for="temporal">
                                    <i class="bi bi-calendar-week fs-4 d-block mb-2"></i>
                                    <span class="fw-bold">Temporal</span>
                                    <small class="d-block text-muted">Estancias cortas</small>
                                </label>
                            </div>
                        </div>
                        <div class="invalid-feedback mt-2">Por favor selecciona un tipo de operación</div>
                    </div>
                </div>

                <!-- Sección de tipo de propiedad mejorada -->
                <div class="card mb-4 border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom-0 py-3">
                        <h5 class="mb-0 fw-bold text-primary">
                            <i class="bi bi-house-gear me-2"></i>Tipo de propiedad
                        </h5>
                    </div>
                    <div class="card-body pt-0">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="TipoPropiedad" class="form-label fw-bold">Tipo</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-building"></i></span>
                                    <select class="form-select" id="TipoPropiedad" name="TipoPropiedad" required>
                                        <option value="" selected disabled>Seleccioná</option>
                                        <option value="Casa">Casa</option>
                                        <option value="Departamento">Departamento</option>
                                        <option value="PH">PH</option>
                                        <option value="Terreno">Terreno</option>
                                        <option value="Local">Local comercial</option>
                                        <option value="Oficina">Oficina</option>
                                    </select>
                                </div>
                                <div class="invalid-feedback">Por favor selecciona un tipo de propiedad</div>
                            </div>
                            <div class="col-md-6">
                                <label for="SubtipoPropiedad" class="form-label fw-bold">Subtipo</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-building-add"></i></span>
                                    <select class="form-select" id="SubtipoPropiedad" name="SubtipoPropiedad">
                                        <option value="" selected disabled>Seleccioná (opcional)</option>
                                        <option value="Casa en barrio cerrado">Casa en barrio cerrado</option>
                                        <option value="Departamento tipo dúplex">Departamento dúplex</option>
                                        <option value="Monoambiente">Monoambiente</option>
                                        <option value="Casa quinta">Casa quinta</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sección de ubicación mejorada -->
                <div class="card mb-4 border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom-0 py-3">
                        <h5 class="mb-0 fw-bold text-primary">
                            <i class="bi bi-geo-alt me-2"></i>Ubicación
                        </h5>
                    </div>
                    <div class="card-body pt-0">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label for="Provincia" class="form-label fw-bold">Provincia</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-map"></i></span>
                                    <select class="form-select" id="Provincia" name="Provincia" required>
                                        <option value="" selected disabled>Seleccioná</option>
                                        <option value="Buenos Aires">Buenos Aires</option>
                                        <option value="Mendoza">Mendoza</option>
                                        <!-- Más provincias -->
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label for="Localidad" class="form-label fw-bold">Localidad</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-geo"></i></span>
                                    <select class="form-select" id="Localidad" name="Localidad" required>
                                        <option value="" selected disabled>Seleccioná</option>
                                        <option value="San Miguel">San Miguel</option>
                                        <option value="Belgrano">Belgrano</option>
                                        <!-- Más localidades -->
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label for="Barrio" class="form-label fw-bold">Barrio (opcional)</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-pin-map"></i></span>
                                    <select class="form-select" id="Barrio" name="Barrio">
                                        <option value="" selected disabled>Seleccioná</option>
                                        <option value="Centro">Centro</option>
                                        <option value="Barrio norte">Barrio norte</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <label for="Calle" class="form-label fw-bold">Calle</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-signpost"></i></span>
                                    <input type="text" class="form-control" id="Calle" name="Calle" placeholder="Nombre de la calle" required>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <label for="Numero" class="form-label fw-bold">Número</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light">#</span>
                                    <input type="text" class="form-control" id="Numero" name="Numero" placeholder="1234" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label for="CodigoPostal" class="form-label fw-bold">Código Postal</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-mailbox"></i></span>
                                    <input type="text" class="form-control" id="CodigoPostal" name="CodigoPostal" placeholder="1661">
                                </div>
                            </div>

                            <div class="col-12 mt-3">
                                <div class="card border-0 shadow-sm">
                                    <div class="card-body p-0">
                                        <div id="map" style="height: 300px; border-radius: 8px;"></div>
                                        <div class="p-3 bg-light border-top">
                                            <small class="text-muted"><i class="bi bi-info-circle me-1"></i>Marca la ubicación exacta en el mapa</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sección de características principales mejorada -->
                <div class="card mb-4 border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom-0 py-3">
                        <h5 class="mb-0 fw-bold text-primary">
                            <i class="bi bi-list-check me-2"></i>Características principales
                        </h5>
                    </div>
                    <div class="card-body pt-0">
                        <div class="row g-3">
                            <div class="col-md-3">
                                <label for="Ambientes" class="form-label fw-bold">Ambientes</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-door-open"></i></span>
                                    <select class="form-select" id="Ambientes" name="Ambientes" required>
                                        <option value="" selected disabled>Seleccioná</option>
                                        <option value="1">1 ambiente</option>
                                        <option value="2">2 ambientes</option>
                                        <option value="3">3 ambientes</option>
                                        <option value="4">4 ambientes</option>
                                        <option value="5+">5+ ambientes</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label for="Dormitorios" class="form-label fw-bold">Dormitorios</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-house-door"></i></span>
                                    <select class="form-select" id="Dormitorios" name="Dormitorios" required>
                                        <option value="" selected disabled>Seleccioná</option>
                                        <option value="1">1 dormitorio</option>
                                        <option value="2">2 dormitorios</option>
                                        <option value="3">3 dormitorios</option>
                                        <option value="4">4 dormitorios</option>
                                        <option value="5+">5+ dormitorios</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label for="Banos" class="form-label fw-bold">Baños</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-bucket"></i></span>
                                    <select class="form-select" id="Banos" name="Banos" required>
                                        <option value="" selected disabled>Seleccioná</option>
                                        <option value="1">1 baño</option>
                                        <option value="2">2 baños</option>
                                        <option value="3">3 baños</option>
                                        <option value="4">4 baños</option>
                                        <option value="5+">5+ baños</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label for="Cocheras" class="form-label fw-bold">Cocheras</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-car-front"></i></span>
                                    <select class="form-select" id="Cocheras" name="Cocheras">
                                        <option value="0" selected>0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <label for="SuperficieCubierta" class="form-label fw-bold">Superficie cubierta (m²)</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-arrows-angle-contract"></i></span>
                                    <input type="number" class="form-control" id="SuperficieCubierta" name="SuperficieCubierta" placeholder="Ej: 80" required>
                                    <span class="input-group-text bg-light">m²</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="SuperficieTotal" class="form-label fw-bold">Superficie total (m²)</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-arrows-angle-expand"></i></span>
                                    <input type="number" class="form-control" id="SuperficieTotal" name="SuperficieTotal" placeholder="Ej: 100">
                                    <span class="input-group-text bg-light">m²</span>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <label for="Antiguedad" class="form-label fw-bold">Antigüedad (años)</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-calendar-date"></i></span>
                                    <input type="number" class="form-control" id="Antiguedad" name="Antiguedad" placeholder="Ej: 5" min="0">
                                    <span class="input-group-text bg-light">años</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check pt-4">
                                    <input class="form-check-input" type="checkbox" id="EnConstruccion" name="EnConstruccion">
                                    <label class="form-check-label fw-bold" for="EnConstruccion">
                                        <i class="bi bi-cone-striped me-1"></i>En construcción
                                    </label>
                                </div>
                                <div class="form-check pt-2">
                                    <input class="form-check-input" type="checkbox" id="A estrenar" name="A estrenar">
                                    <label class="form-check-label fw-bold" for="A estrenar">
                                        <i class="bi bi-gift me-1"></i>A estrenar
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sección de precio mejorada -->
                <div class="card mb-4 border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom-0 py-3">
                        <h5 class="mb-0 fw-bold text-primary">
                            <i class="bi bi-currency-exchange me-2"></i>Precio
                        </h5>
                    </div>
                    <div class="card-body pt-0">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="MonedaPrecio" class="form-label fw-bold">Moneda</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-cash-stack"></i></span>
                                    <select class="form-select" id="MonedaPrecio" name="MonedaPrecio" required>
                                        <option value="ARS" selected>Pesos Argentinos (ARS)</option>
                                        <option value="USD">Dólares Estadounidenses (USD)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="Precio" class="form-label fw-bold">Precio</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light fw-bold" id="simboloMoneda">$</span>
                                    <input type="number" class="form-control" id="Precio" name="Precio" placeholder="Ej: 150000" required>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <label for="MonedaExpensas" class="form-label fw-bold">Moneda expensas</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light"><i class="bi bi-receipt"></i></span>
                                    <select class="form-select" id="MonedaExpensas" name="MonedaExpensas">
                                        <option value="ARS" selected>Pesos Argentinos (ARS)</option>
                                        <option value="USD">Dólares Estadounidenses (USD)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="Expensas" class="form-label fw-bold">Expensas (opcional)</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light fw-bold" id="simboloExpensas">$</span>
                                    <input type="number" class="form-control" id="Expensas" name="Expensas" placeholder="Ej: 10000">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sección de descripción mejorada -->
                <div class="card mb-4 border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom-0 py-3">
                        <h5 class="mb-0 fw-bold text-primary">
                            <i class="bi bi-text-paragraph me-2"></i>Descripción
                        </h5>
                    </div>
                    <div class="card-body pt-0">
                        <div class="mb-3">
                            <label for="Titulo" class="form-label fw-bold">Título del aviso</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="bi bi-card-heading"></i></span>
                                <input type="text" class="form-control" id="Titulo" name="Titulo" placeholder="Ej: 'Departamento luminoso de 2 ambientes en San Miguel'" required>
                            </div>
                            <small class="text-muted">Sé claro y atractivo (máx. 70 caracteres)</small>
                        </div>
                        <div class="mb-3">
                            <label for="Descripcion" class="form-label fw-bold">Descripción detallada</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light align-items-start"><i class="bi bi-textarea-t"></i></span>
                                <textarea class="form-control" id="Descripcion" name="Descripcion" rows="5" placeholder="Describí las características principales de la propiedad, su ubicación, ambientes, servicios cercanos, etc." required></textarea>
                            </div>
                            <div class="d-flex justify-content-between mt-1">
                                <small class="text-muted">Sé detallado para atraer más interesados</small>
                                <small class="text-muted"><span id="charCount">0</span>/500 caracteres</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Botones de acción mejorados -->
                <div class="d-flex justify-content-between mb-5">
                    <a asp-page="/Index" class="btn btn-outline-secondary px-4 py-2">
                        <i class="bi bi-arrow-left me-2"></i>Cancelar
                    </a>
                    <a asp-page="/PostStep2" class="btn btn-primary px-4 py-2">
                        Siguiente <i class="bi bi-arrow-right ms-2"></i>
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="~/js/post.js"></script>
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script>
    // Inicializar mapa
    const map = L.map('map').setView([-34.6037, -58.3816], 13);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    // Marcador arrastrable
    const marker = L.marker([-34.6037, -58.3816], {draggable: true}).addTo(map);

    // Actualizar coordenadas al mover el marcador
    marker.on('dragend', function(e) {
        const coord = marker.getLatLng();
        console.log('Coordenadas:', coord.lat, coord.lng);
        // Aquí se podría guardar las coordenadas en campos ocultos del formulario
    });

    // Cambiar símbolo monetario según selección
    document.getElementById('MonedaPrecio').addEventListener('change', function() {
        const simbolo = this.value === 'USD' ? 'USD$' : '$';
        document.getElementById('simboloMoneda').textContent = simbolo;
    });

    document.getElementById('MonedaExpensas').addEventListener('change', function() {
        const simbolo = this.value === 'USD' ? 'USD$' : '$';
        document.getElementById('simboloExpensas').textContent = simbolo;
    });

    // Contador de caracteres para descripción
    document.getElementById('Descripcion').addEventListener('input', function() {
        const charCount = this.value.length;
        document.getElementById('charCount').textContent = charCount;
    });
</script>

